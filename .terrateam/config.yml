# Terrateam Configuration for Centralized Pipeline

access_control:
  policies:
    - tag_query: ""
      plan: ["*"]
      apply: ["team:platform", "team:sre"]

apply_requirements:
  create_pending_apply_check: true
  checks:
    - tag_query: ""
      approved:
        enabled: false  # Set to false for testing, true for production
        any_of_count: 1

dirs:
  ".":
    tags: ["centralized"]
    when_modified:
      file_patterns:
        - "*.tf"
        - "modules/**/*.tf"
        - "scripts/**/*.py"

hooks:
  all:
    pre:
      - type: run
        cmd: ["python3", ".terrateam/scripts/team-manager.py", "identify-team"]
      - type: run
        cmd: ["python3", ".terrateam/scripts/update-modules.py"]
      - type: run
        cmd: ["python3", ".terrateam/scripts/opa-validate.py"]

workflows:
  - tag_query: "centralized"
    plan:
      - type: init
      - type: plan
    apply:
      - type: init
      - type: plan
      - type: apply
